---
phase: 02-dependency-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - converge-platform/converge-core/src/traits/mod.rs
  - converge-platform/converge-core/src/lib.rs
autonomous: true

must_haves:
  truths:
    - "traits/ module exists and is exported from lib.rs"
    - "Executor trait is defined with Send + Sync bounds"
    - "Randomness trait is defined with Send + Sync bounds"
    - "Fingerprint trait is defined with Send + Sync bounds"
    - "All traits use generic parameters, not associated types"
  artifacts:
    - path: "converge-platform/converge-core/src/traits/mod.rs"
      provides: "Executor, Randomness, Fingerprint stub traits"
      contains: "pub trait Executor"
    - path: "converge-platform/converge-core/src/lib.rs"
      provides: "traits module export"
      contains: "pub mod traits"
  key_links:
    - from: "converge-platform/converge-core/src/lib.rs"
      to: "converge-platform/converge-core/src/traits/mod.rs"
      via: "pub mod traits declaration"
      pattern: "pub mod traits"
---

<objective>
Create the traits module with stub trait definitions for Executor, Randomness, and Fingerprint.

Purpose: Establish the abstraction layer that will replace forbidden dependencies (rayon, rand, sha2/hex). These traits define capability boundaries - converge-core defines the interface, external crates provide implementations.

Output: New `src/traits/mod.rs` with three stub traits, exported from lib.rs.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-dependency-cleanup/02-CONTEXT.md
@converge-platform/converge-core/src/lib.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create traits module with stub traits</name>
  <files>converge-platform/converge-core/src/traits/mod.rs</files>
  <action>
Create new file `src/traits/mod.rs` with three stub traits:

1. **Executor trait** - Replaces rayon parallel execution
   - Method: `fn execute_parallel<T, F, R>(&self, items: &[T], f: F) -> Vec<R>` where F: Fn(&T) -> R + Send + Sync, T: Sync, R: Send
   - Trait bounds: `Send + Sync`
   - Doc comment explaining this abstracts parallel/sequential execution

2. **Randomness trait** - Replaces rand
   - Method: `fn random_u32(&self) -> u32`
   - Method: `fn random_bytes(&self, buf: &mut [u8])`
   - Trait bounds: `Send + Sync`
   - Doc comment explaining this abstracts random number generation

3. **Fingerprint trait** - Replaces sha2/hex
   - Method: `fn compute(&self, data: &[u8]) -> [u8; 32]`
   - Method: `fn to_hex(hash: &[u8; 32]) -> String`
   - Method: `fn from_hex(s: &str) -> Result<[u8; 32], FingerprintError>`
   - Trait bounds: `Send + Sync`
   - Include `FingerprintError` enum with `InvalidHex` and `InvalidLength` variants

Add module-level documentation explaining:
- These are capability boundary traits
- converge-core defines interfaces only
- Implementations belong in converge-runtime or other capability crates
- All traits require Send + Sync for thread safety

Use generic parameters (not associated types) per CONTEXT.md decision.
  </action>
  <verify>
```bash
cd converge-platform/converge-core && cargo check 2>&1 | head -20
```
File exists and compiles (may have unused warnings, that's OK).
  </verify>
  <done>
- `src/traits/mod.rs` exists with Executor, Randomness, Fingerprint traits
- Each trait has Send + Sync bounds
- Each trait has appropriate method signatures
- Module has documentation explaining capability boundary pattern
  </done>
</task>

<task type="auto">
  <name>Task 2: Export traits module from lib.rs</name>
  <files>converge-platform/converge-core/src/lib.rs</files>
  <action>
Add `pub mod traits;` declaration to lib.rs.

Place it in the module declaration section (after line 71, with other pub mod declarations like `pub mod agents`, `pub mod backend`, etc.).

Add re-export of the trait types for convenience:
```rust
// Re-export capability boundary traits
pub use traits::{Executor, Fingerprint, FingerprintError, Randomness};
```

Place the re-export near the other capability re-exports (around line 107 where capability types are re-exported).
  </action>
  <verify>
```bash
cd converge-platform/converge-core && cargo check 2>&1 | head -20
```
Crate compiles successfully.
  </verify>
  <done>
- `pub mod traits;` declared in lib.rs
- Executor, Randomness, Fingerprint, FingerprintError re-exported from crate root
- Crate compiles with `cargo check`
  </done>
</task>

</tasks>

<verification>
```bash
cd converge-platform/converge-core && cargo check
```
- No compilation errors
- traits module is accessible

```bash
grep -n "pub mod traits" converge-platform/converge-core/src/lib.rs
grep -n "pub trait Executor" converge-platform/converge-core/src/traits/mod.rs
grep -n "pub trait Randomness" converge-platform/converge-core/src/traits/mod.rs
grep -n "pub trait Fingerprint" converge-platform/converge-core/src/traits/mod.rs
```
- All declarations found
</verification>

<success_criteria>
1. `src/traits/mod.rs` exists with three trait definitions
2. All traits have Send + Sync bounds
3. lib.rs exports the traits module
4. `cargo check` passes (warnings OK, errors not OK)
5. Traits are re-exported from crate root for convenience
</success_criteria>

<output>
After completion, create `.planning/phases/02-dependency-cleanup/02-01-SUMMARY.md`
</output>

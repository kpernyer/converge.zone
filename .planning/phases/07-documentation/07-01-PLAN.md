---
phase: 07-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - converge-platform/converge-core/src/lib.rs
  - converge-platform/converge-core/src/types/mod.rs
  - converge-platform/converge-core/src/traits/mod.rs
  - converge-platform/converge-core/src/gates/mod.rs
autonomous: true

must_haves:
  truths:
    - "lib.rs has a formal Nine Design Tenets section with examples for each tenet"
    - "lib.rs has a Purity Declaration section stating ALLOWED/FORBIDDEN dependencies"
    - "types/, traits/, gates/ modules have comprehensive doc comments"
    - "cargo doc builds without warnings"
    - "doc examples compile (where possible)"
  artifacts:
    - path: "converge-platform/converge-core/src/lib.rs"
      provides: "Crate-level documentation with tenets and purity"
      contains: "# Design Tenets"
    - path: "converge-platform/converge-core/src/types/mod.rs"
      provides: "Module-level documentation for types"
      contains: "//! # Design Principles"
    - path: "converge-platform/converge-core/src/traits/mod.rs"
      provides: "Module-level documentation for traits"
      contains: "//! # Capability Boundary Traits"
    - path: "converge-platform/converge-core/src/gates/mod.rs"
      provides: "Module-level documentation for gates"
      contains: "//! # Design Axiom"
  key_links:
    - from: "lib.rs Design Tenets section"
      to: "PROJECT.md nine tenets"
      via: "content alignment"
      pattern: "Explicit Authority|Convergence Over Control Flow|Append-Only Truth"
    - from: "types/mod.rs"
      to: "design tenets"
      via: "references to tenets in design principles"
      pattern: "Promotion invariant|Type safety"
    - from: "gates/mod.rs"
      to: "design tenets"
      via: "references to tenets in design axiom"
      pattern: "Agents suggest, engine decides"
---

<objective>
Add comprehensive Nine Design Tenets and Purity Declaration documentation to lib.rs, and audit/enhance module documentation in types/, traits/, gates/.

Purpose: Fulfill REQ-DOC-03 (purity declarations), REQ-DOC-04 (nine tenets documented), and REQ-TYPE-09 (module comprehensive doc comments). Users reading crate docs will understand the architectural axioms that converge-core enforces.

Output: Enhanced lib.rs with formal documentation sections, and audited module docs with tenet references.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-documentation/07-RESEARCH.md

# Source files
@converge-platform/converge-core/src/lib.rs
@converge-platform/converge-core/PURITY.md
@converge-platform/converge-core/src/types/mod.rs
@converge-platform/converge-core/src/traits/mod.rs
@converge-platform/converge-core/src/gates/mod.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Nine Design Tenets section to lib.rs</name>
  <files>converge-platform/converge-core/src/lib.rs</files>
  <action>
Add a new `# Design Tenets` section to lib.rs crate-level docs, after the existing `## Guarantees` section. Structure:

```rust
//! # Design Tenets
//!
//! Converge is built on nine non-negotiable design tenets. These are axioms
//! that `converge-core` exists to encode, enforce, and protect.
//!
//! ## 1. Explicit Authority
//!
//! **Axiom:** No defaults that grant authority. Authority is always explicit, typed, and traceable.
//!
//! **Why:** Implicit authority leads to security holes and audit gaps.
//!
//! **In code:** [`AuthorityGrant`] has `pub(crate)` constructors — external code cannot
//! create arbitrary authority. All promotion requires explicit grants.
//!
//! ## 2. Convergence Over Control Flow
//! ...
```

For each tenet (9 total from PROJECT.md):
1. Explicit Authority
2. Convergence Over Control Flow
3. Append-Only Truth
4. Agents Suggest, Engine Decides
5. Safety by Construction
6. Transparent Determinism
7. Human Authority First-Class
8. No Hidden Work
9. Scale by Intent Replication

Include for each:
- **Axiom** statement (1 sentence)
- **Why** it matters (1 sentence)
- **In code** reference to relevant types/traits

Link to concrete types where applicable (AuthorityGrant, Fact, PromotionGate, TraceLink, etc.).
Do NOT use `ignore` or `no_run` code examples - use type references with brackets instead.
  </action>
  <verify>
Run `cargo doc --no-deps -p converge-core` in converge-platform directory - should build without warnings.
Grep lib.rs for "# Design Tenets" to confirm section exists.
  </verify>
  <done>lib.rs has a complete "Design Tenets" section documenting all 9 tenets with axiom, why, and code references.</done>
</task>

<task type="auto">
  <name>Task 2: Add Purity Declaration section to lib.rs</name>
  <files>converge-platform/converge-core/src/lib.rs</files>
  <action>
Add a `# Purity Declaration` section to lib.rs crate-level docs, after the Design Tenets section. Structure:

```rust
//! # Purity Declaration
//!
//! `converge-core` is pure by design: no I/O, no runtime behavior, no implementation
//! logic — only types, traits, and promotion gates.
//!
//! ## Why Purity Matters
//!
//! - **Portability**: Compiles to WebAssembly, embedded, native
//! - **Testability**: Deterministic, no mocking infrastructure
//! - **Stability**: No external runtime dependencies
//!
//! ## Allowed Dependencies
//!
//! | Crate | Purpose | Why Allowed |
//! |-------|---------|-------------|
//! | thiserror | Error derive macros | Pure, compile-time only |
//! | serde | Serialization traits | Pure, no I/O |
//! | serde_json | JSON types | Structured content only |
//! | tracing | Instrumentation facade | No subscriber in core |
//! | strum | Enum derives | Pure, compile-time only |
//! | typed-builder | Builder derives | Pure, compile-time only |
//! | hex | Hex encoding | Pure utility |
//!
//! ## Forbidden Dependencies
//!
//! | Category | Examples | Why |
//! |----------|----------|-----|
//! | Async runtimes | tokio, async-std | Implies execution |
//! | HTTP/Network | reqwest, axum | Implies I/O |
//! | Parallelism | rayon | Runtime concern |
//! | Randomness | rand | Non-deterministic |
//! | LLM execution | burn, llama-cpp | Implies inference |
//!
//! See [`PURITY.md`](../PURITY.md) for the complete policy and enforcement details.
//! These constraints are enforced by `deny.toml` and CI.
```

Reference PURITY.md for full details. Keep lib.rs section concise (summary tables, not exhaustive lists).
  </action>
  <verify>
Run `cargo doc --no-deps -p converge-core` in converge-platform directory - should build without warnings.
Grep lib.rs for "# Purity Declaration" to confirm section exists.
  </verify>
  <done>lib.rs has a "Purity Declaration" section with ALLOWED/FORBIDDEN dependency tables.</done>
</task>

<task type="auto">
  <name>Task 3: Audit and fix doc examples</name>
  <files>converge-platform/converge-core/src/lib.rs</files>
  <action>
Audit the Quick Start example in lib.rs:
1. Check if the example compiles with `cargo test --doc -p converge-core`
2. If it fails:
   - Add `ignore` if the example requires runtime crate features not in core
   - OR fix the example to use only converge-core types
   - OR convert to prose explaining the pattern without runnable code

The existing Quick Start uses Engine, Context, ContextKey, SeedAgent, ReactOnceAgent.
These ARE in converge-core, so the example should work. If it doesn't compile:
- Check imports are correct
- Check types exist in the public API
- If types are internal/deprecated, update example to use current API

If doc tests pass already, document this in the SUMMARY as "doc examples verified".
  </action>
  <verify>
Run `cargo test --doc -p converge-core` in converge-platform directory.
Expected: All doc tests pass OR are marked with appropriate ignore/no_run.
  </verify>
  <done>Doc examples either compile or are appropriately marked with ignore/no_run with explanatory comments.</done>
</task>

<task type="auto">
  <name>Task 4: Audit and enhance types/, traits/, gates/ module documentation</name>
  <files>
    converge-platform/converge-core/src/types/mod.rs
    converge-platform/converge-core/src/traits/mod.rs
    converge-platform/converge-core/src/gates/mod.rs
  </files>
  <action>
Audit and enhance the existing module-level documentation in types/, traits/, gates/ to ensure:

1. **types/mod.rs** - Already has good docs. Enhance by:
   - Adding a "Relationship to Design Tenets" section referencing which tenets this module enforces
   - Ensure each submodule purpose is clear
   - Add cross-references to related modules (traits, gates)

2. **traits/mod.rs** - Already has excellent docs. Enhance by:
   - Adding a brief "Tenet Alignment" note explaining this implements "converge-core defines interfaces only"
   - Ensure Thread Safety section is present (it is)
   - Verify all trait groups are documented (they are)

3. **gates/mod.rs** - Already has comprehensive docs. Enhance by:
   - Expanding the "Design Axiom" to reference tenet #4 explicitly
   - Ensure the invariants list is complete
   - Add cross-reference to types/provenance.rs for PromotionRecord

For each file, the enhancement should be MINIMAL - these already have good documentation.
Focus on:
- Tenet references (link module purpose to specific design tenets)
- Cross-module references (how modules relate to each other)
- Verify all public items are documented

Do NOT rewrite existing documentation - only add missing tenet references and cross-links.
  </action>
  <verify>
Run `cargo doc --no-deps -p converge-core` in converge-platform directory - should build without warnings.
Grep each mod.rs for tenet-related content:
- `grep -c "tenet\|Tenet\|Design" converge-platform/converge-core/src/types/mod.rs`
- `grep -c "tenet\|Tenet\|Design" converge-platform/converge-core/src/traits/mod.rs`
- `grep -c "tenet\|Tenet\|Design" converge-platform/converge-core/src/gates/mod.rs`
Each should return > 0.
  </verify>
  <done>types/, traits/, gates/ module docs have tenet references, cross-module links, and pass cargo doc without warnings.</done>
</task>

</tasks>

<verification>
All checks pass from converge-platform directory:
1. `cargo doc --no-deps -p converge-core` builds without warnings
2. `grep -c "# Design Tenets" converge-core/src/lib.rs` returns 1
3. `grep -c "# Purity Declaration" converge-core/src/lib.rs` returns 1
4. `cargo test --doc -p converge-core` passes
5. `grep -c "tenet\|Tenet" converge-core/src/types/mod.rs` returns > 0
6. `grep -c "tenet\|Tenet" converge-core/src/traits/mod.rs` returns > 0
7. `grep -c "tenet\|Tenet" converge-core/src/gates/mod.rs` returns > 0
</verification>

<success_criteria>
- lib.rs has formal Nine Design Tenets section with all 9 tenets documented
- lib.rs has Purity Declaration section with ALLOWED/FORBIDDEN tables
- types/, traits/, gates/ modules have comprehensive doc comments with tenet references
- cargo doc builds without warnings
- Doc tests pass or have appropriate annotations
</success_criteria>

<output>
After completion, create `.planning/phases/07-documentation/07-01-SUMMARY.md`
</output>
